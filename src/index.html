<!DOCTYPE html>
  <html>
    <head>
      <meta charset="UTF-8">
      <title>RTS</title>
      <link rel="stylesheet" type="text/css" href="./styles/base.css">
      <link rel="stylesheet" type="text/css" href="./styles/ui.css">

      <link rel="stylesheet" type="text/css" href="./styles/smartbanner.css">
      <link rel="stylesheet" type="text/css" href="./styles/race.css">
      <link rel="stylesheet" type="text/css" href="./styles/users.css">

      <link rel="stylesheet" type="text/css" href="./styles/reg-fullscreenpopup.css">
    </head>
    <body>
      <div class="content">

        <header id="smarbanner" class="smartbanner ui-block">
          <div class="smartbanner-readers">
            <div class="smartbanner-reader smartbanner-portablereader">
              <span class="smartbanner-reader-title">Portable reader:</span>
              <span class="smartbanner-reader-status"></span>
              <div class="smartbanner-reader-signal"></div>
            </div>
            <div class="smartbanner-reader smartbanner-mainreader">
              <span class="smartbanner-reader-title">Main reader:</span>
              <span class="smartbanner-reader-status"></span>
              <div class="smartbanner-reader-signal"></div>
            </div>
          </div>
        </header>

        <main>
          <div id="race" class="race ui-block">
            <table>
                <tr class="race-header">
                    <th class="race-row-name">Имя</th>
                    <th class="row-row-time">Общее время</th>
                </tr>
            </table>
          </div>

          <div id="users" class="users ui-block">
              <table>
                  <tr class="users-header">
                      <th class="users-row-name">Имя</th>
                      <th class="users-row-best-time">Лучшее время</th>
                      <th class="users-row-best-count">Всего заездов</th>
                  </tr>
              </table>
          </div>
        </main>

        <div id="regPopup" class="reg-fullscreenpopup">
          <div class="reg-fullscreenpopup-content">
            <div class="reg-fullscreenpopup-close">Закрыть</div>
            <h2>Новый участник</h2>
            <input class="reg-fullscreenpopup-field reg-fullscreenpopup-uid ui-input" type="text" placeholder="Tag">
            <input class="reg-fullscreenpopup-field reg-fullscreenpopup-firstname ui-input" type="text" placeholder="Имя">
            <input class="reg-fullscreenpopup-field reg-fullscreenpopup-lastname ui-input" type="text" placeholder="Фамилия">
            <button class="reg-fullscreenpopup-submit ui-button">Добавить</button>
          </div>
        </div>

<!--        TODO // enable/disable reader listening -->
        <footer>
          <button>PortableReaderOn</button>
          <button>MainReaderOn</button>
        </footer>

      </div>
    </body>
    <script>
     const { ipcRenderer } = require('electron');

     const smartbannerComponent = require('./view-components/smartbanner');
     const raceComponents = require('./view-components/race');
     const usersComponent = require('./view-components/users');
     const regPopupComponent = require('./view-components/reg-popup');

     const windowDispatcher = {
      sendRendererEvent(type, data) {
        ipcRenderer.send(type, data);
      },
      onRendererEvent(type, listener) {
          ipcRenderer.on(type, listener)
      }
     };

     smartbannerComponent(smarbanner, windowDispatcher);
     raceComponents(race, windowDispatcher);
     usersComponent(users, windowDispatcher);
     regPopupComponent(regPopup, windowDispatcher);

     const fakePortableTag = uid => windowDispatcher.sendRendererEvent('fakeProtableTag', uid);
     const fakeMainTag = uid => windowDispatcher.sendRendererEvent('fakeMainTag', uid);

     document.addEventListener('DOMContentLoaded', () => {
      windowDispatcher.sendRendererEvent('onViewReady');
     });
    </script>
  </html>
